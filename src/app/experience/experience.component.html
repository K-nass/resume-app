<div class="container-md mt-3">
    <div class="container py-5">
        <form>
            <fieldset class="border p-4 rounded shadow-sm">
                <legend class="float-none w-auto px-2">Work Experience</legend>
                <div id="experienceList">
                    <button *ngIf="!experiences.length" type="button" class="btn btn-primary" (click)="addExperience()">
                        Add Experience
                    </button>
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item" *ngFor="let exp of experiences; let i = index">
                            <h2 class="accordion-header" [id]="'heading' + i">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    [attr.data-bs-target]="'#collapse' + i" aria-expanded="true"
                                    [attr.aria-controls]="'collapse' + i">
                                    Work History Summary #{{ i + 1 }}
                                </button>
                            </h2>
                            <div [id]="'collapse' + i" class="accordion-collapse collapse show"
                                [attr.aria-labelledby]="'heading' + i" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <app-experience-item [index]="i"></app-experience-item>
                                </div>
                                <div class="col-12 text-end">
                                    <button (click)="generateWithAI(i)" type="button"
                                        class="btn btn-outline-secondary shadow-sm">
                                        âœ¨ Generate with AI
                                    </button>
                                </div>
                                <div *ngIf="enhancedText || loading" class="col-12 mt-3">
                                    <div *ngIf="loading"
                                        class="d-flex align-items-center bg-light rounded px-3 py-2 shadow-sm border">
                                        <div class="spinner-border text-primary me-3" role="status"
                                            style="width: 1.5rem; height: 1.5rem;">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <strong>Generating summary...</strong>
                                    </div>

                                    <div *ngIf="!loading" class="bg-light rounded p-3 shadow-sm border text-dark">
                                        <p class="mb-0" style="white-space: pre-line;">{{ enhancedText }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="position-relative mt-3">
                                <button type="button" class="btn btn-primary" (click)="addExperience()">
                                    Add Experience
                                </button>

                                <button (click)="removeExperience(i)" type="button"
                                    class="btn btn-danger btn-sm position-absolute top-0 end-0 m-2">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
        </form>
    </div>
</div>